<!doctype html>
<html manifest='offline.manifest'>
<head>
<meta charset="utf-8">
<title>创意罗盘</title>
<style>
body,html,canvas{margin:0;padding:0;}
body,html{width: 100%;height:100%;}
canvas{/*transform-origin:0 0;transform:scale(0.5,0.5);/* */}
</style>
<meta name="viewport"/>
<script>var compass = function() {
function s(e) {
for (var r, a = e.split(/\r\n?|\n/), t = [], n = 0; n < a.length; n++) {
var i = a[n], l = i.search(/\S/);
if (l != i.length - 1) if ("#" == i.charAt(l)) {
var r = t[t.length - 1], o = i.substr(l + 1);
r.content ? r.content += "\n" + o : r.content = o;
} else {
var v = t[l - 1], r = {
children: []
};
v && v.children.push(r), t[l] = r, t.length = l + 1, h(i, r);
}
}
return t[0];
}
function h(e, a) {
var t = e.match(/\s*(.*?[^\\])(?:\{(\w*)(#\w+)?(?:,(.+))?\})?$/);
a.title = t[1], a.id = t[2], a.fill = t[3];
var r = t[4];
if (r) {
r = r.split(",");
for (var n = r.length; n--; ) e = r[n].split("="), a[e[0]] = e[1];
}
}
function F() {
return y.concat();
}
function x(e) {
var a = e.id || e;
return e = localStorage.getItem(m + a), e ? JSON.parse(e) : (console.error("data not found:", a), 
{});
}
function S(e) {
var a = y, t = e.id || (e.id = T()), r = M(t), n = a[r];
n ? a.splice(r, 1) : n = {
createTime: +new Date(),
id: e.id
}, n.title = e.title, n.fill = e.fill, n.icon = e.icon, n.updateTime = +new Date(), 
a.unshift(n), localStorage.setItem(m, JSON.stringify(y)), localStorage.setItem(m + t, JSON.stringify(e));
}
function C(e) {
var a = e.id, t = M(a);
t >= 0 && (y.splice(t, 1), localStorage.setItem(m, JSON.stringify(y)), localStorage.removeItem(m + a));
}
function M(e) {
for (var a = y, t = a.length; t--; ) if (a[t].id == e) return t;
}
function T() {
for (var e = ((new Date() >> 24 | 4095) << 24).toString(16) + (4095 * Math.random() | 0).toString(16); e.length < 6; ) e += "0";
return e;
}
function P(e, a) {
ve(a), O(e);
}
function O(e) {
e != G && (X = !0), G = e, $ || L(B), $ = 1;
}
function B() {
var e = +new Date();
$ = -1;
var a = H.getContext("2d");
if (null != H.nativeId) {
E && console.error("invalid depth status!!!"), E++;
try {
X && (X = !1, a.clearRect(0, 0, H.width, H.height));
var t = G(a);
} finally {
H.commit(!0);
}
E--;
} else t = G(a);
t || $ > 0 ? ($ = 1, L(B)) : $ = 0, R(e, +new Date());
}
function R(e, a) {
if (_++, W += e, J += a, _ > 20) {
var t = [ 1e3 * _ / (a - N), (J - W) / _, q / _ ].map(function(e) {
return e.toFixed(1);
}).join("	");
Y.push(t) > 4 && Y.shift(), console.log("fps:" + t), N = a, _ = W = J = q = 0;
}
}
function j(e) {
q += +e;
}
function oe(e, a) {
if (H != e) {
for (var t = z.length; t--; ) e.addEventListener(z[t], de);
H = e, a && ve(a);
}
}
function ve(e) {
ue(!0);
var a = U;
return U = e, a;
}
function ce(e, a, t) {
Q = new Date(), ae = 0, V && clearTimeout(V), V = setTimeout(function() {
V = 0, U(0, e, ie, le, 0 | re, 0 | ne);
}, Br), U(-1, e, ie = a, le = t, re = a, ne = t), console.log("start", new Date() - Q);
}
function fe(e, a, t) {
V && (Math.abs(a - ie) > ee || Math.abs(t - le) > ee) && (V = clearTimeout(V)), 
ae++, re = .8 * re + .2 * a, ne = .8 * ne + .2 * t, U(-2, e, ie, le, 0 | re, 0 | ne);
}
function se(e, a, t) {
function r() {
V && new Date() - Q < Er ? Z = setTimeout(r, Er) : (0 > ae && U(K, e, ie, le, a, t), 
3 == K && prompt(Y.join("\n")), K = 0);
}
try {
V && (V = clearTimeout(V), K ? (K++, clearTimeout(Z)) : K = 1, Z = setTimeout(r, Er)), 
U(-3, e, ie, le, a, t);
} finally {
ue();
}
}
function he(e) {
for (var a = e.length; a--; ) H.removeEventListener(e[a], de);
}
function ue(e) {
V && (V = clearTimeout(V)), e && Z && (Z = clearTimeout(Z)), ae = -1, te = null;
}
function de(e) {
try {
var a = new Date(), t = e.changedTouches && e.changedTouches[0] || e, r = t.clientX - (te || (te = e.srcElement.getBoundingClientRect())).left, n = t.clientY - te.top;
switch (e.type) {
case "touchstart":
var a = new Date();
z.length > 6 && he(z.splice(4));
case "mousedown":
e.preventDefault(), 0 > ae && ce(e, r, n), console.log("start time:" + (new Date() - a));
break;
case "mousemove":
z.length > 6 && he(z.splice(0, 4));
case "touchmove":
if (console.log("move:" + ae), 0 > ae) break;
fe(e, r, n), e.preventDefault();
break;
case "touchend":
case "touchcancel":
case "mouseout":
case "mouseup":
if (0 > ae) break;
se(e, r, n);
break;
default:
console.warn("unknow event:", e.type, e);
}
} finally {
j(new Date() - a);
}
}
function pe() {
function c(a) {
v = a.canvas.height;
var n = e.length, l = v - o, c = i;
0 > l && l > c && (c = l - 50 * Math.log((l - i) / 50 + 1), a.clearRect(0, c + v, a.canvas.width, v));
for (var f = 0; n > f; f++) {
var s = e[f], h = r.indexOf(s);
if (h >= 0 || !r.length) {
var u = f << 2, d = t[u], p = t[u + 1] + c, g = t[u + 3] + c;
if (p > v || 0 > g) continue;
a.save();
try {
a.translate(d, p), !s(a, t[u + 2] - d, g - p) && h >= 0 && r.splice(h, 1);
} finally {
a.restore();
}
}
}
return r.length;
}
function f(r, f, s, h, u, d) {
var g, p = t.length;
for (h -= n, d -= i; p > 0; ) {
var m = t[--p], y = t[--p], w = t[--p], F = t[--p], x = a[p >> 2];
if (x && m >= h && h >= w && y >= s && s >= F && (g = x(r, f, ie - F, le - w, u - F, d - w))) break;
}
if (!g && -2 == r && o > v) {
var m = d + i - l;
i = m > 0 ? 0 : v > m + o ? m : m, O(c);
}
if (-1 == r) n = i; else if (-3 == r) var S = setInterval(function() {
var t = (e.length, v - o);
if (t > i) {
var r = t - i;
i = Math.min(i + 10 + .1 * r, t), O(c);
} else clearInterval(S);
}, 20);
l = d;
}
var v, e = [], a = [], t = [], r = [], n = 0, i = 0, l = 0, o = 0;
return P(c, f), function(n, i, l, v, f, s) {
s > o && (o = s);
var h = e.indexOf(n);
return h >= 0 ? (i && (a[h] = i, f > l && t.splice(4 * h, 4, l, v, f, s)), r.indexOf(n) < 0 && r.push(n), 
O(c)) : (e.push(n), a.push(i), t.push(l, v, f, s)), arguments.callee;
};
}
function Se(e, a, t, r, n, i, l, o) {
var v = t - a >> 1, c = n - r, f = i.length, s = c / f | 0, h = .8 * v | 0, u = t - v / 1.5 | 0, d = [], p = o || Ce;
for (e.fillStyle = ge, e.strokeStyle = me, p(e, a, t, r, n), e.fillStyle = me, e.font = (0 | h) + "px STHeiti serif", 
e.textAlign = "center"; f--; ) if (f != l) {
var g = r + f * s;
d.push([ g + v, g + s - v, f ]), e.fillText(i[f], g + .5 * s, u);
}
return l >= 0 && (f = l, e.fillStyle = ye, g = r + f * s, p(e, a, t, g, g + s), 
e.fillStyle = we, e.fillText(i[f], g + .5 * s, u)), d;
}
function Ce(e, a, t, r, n) {
var i = (t - a) / 2;
e.beginPath(), e.arc(r + i, a + i, i, Math.PI / 2, 1.5 * Math.PI, !1), e.lineTo(n - i, a), 
e.arc(n - i, a + i, i, -Math.PI / 2, Math.PI / 2, !1), e.lineTo(r, t), e.fill();
}
function Me(e, a, t) {
a = a || 16, t = t || "", "string" == typeof e && (e = Te(e));
var r = [], n = a - Math.min(a >> 2, 16);
return function(i) {
var l = i[t], o = r.lastIndexOf(l);
return o >= 0 ? n > o && (r.splice(o, 1), r.push(l)) : (l = [], l[0] = r.length > a ? e(r.shift().splice(0)[0]) : e(), 
r.push(i[t] = l)), l;
};
}
function be(e, a, t) {
var r = e[0] - a[0], n = e[1] - a[1];
return t && (r > t || -t > r || n > t || -t > n) ? 2147483647 : Math.sqrt(r * r + n * n);
}
function Te() {
return function(e) {
return e || De();
};
}
function He(e, a, t) {
var r = e.cmds;
switch (a) {
case Re:
case Be:
case Ee:
case je:
case Ne:
var n = 255 * e.globalAlpha + .5;
case Je:
if (!e._configJSON) {
var i = Ke(e);
He(e, Le, i);
}
break;
case $e:
if (!t.cmds.length) return;
var n = t.nativeId || 0;
t = t.cmds.splice(0).join("");
}
var l = [ a, t.length ];
return null != n && (l[1]++, l.push(n)), l = l.map(Qe), l.push(t), r.push(l.join("")), 
Je == a ? e.commit(!1) : void 0;
}
function De() {
return window.nativeHost ? new ze() : document.createElement("canvas");
}
function ze(e) {
this.style = {}, this.stack = [], this.saveCount = 0, this._style = {
font: "10px sans-serif",
fillStyle: "#000",
strokeStyle: "#000",
lineCap: "butt",
lineJoin: "miter",
lineWidth: 1,
miterLimit: 10,
textAlign: "left",
textBaseline: "alphabetic"
}, this._styleJSON, this.nativeId = Xe.createCanvas(e >= 0 ? e : -1), this.canvas = this, 
this.globalAlpha = 1, this.cmds = [];
}
function Ue(e) {
return e && String.fromCharCode.apply(String, e);
}
function Qe(e) {
return String.fromCharCode(e);
}
function Ke(e) {
if (e._styleJSON) return e._styleJSON;
var a = e._style, t = [ '{"' ];
for (var r in a) t.push(r, '":'), (r = a[r]) instanceof Object ? t.push('"', String(r), '","') : "string" == typeof r ? t.push('"', Ve(r).replace(/["\\]/g, "\\$&"), '","') : t.push(r, ',"');
return t.push(t.pop().replace(',"', "}")), e._styleJSON = t.join("");
}
function Ve(e) {
var a = e.match(/^rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\.\d]+))?|^#[0-9a-f]+/i);
if (a) {
var t = a[1];
if (t) {
for (e = (255 * (a[4] || 1) << 24 | t << 16 | a[2] << 8 | a[3]).toString(16); e.length < 8; ) e = "0" + e;
e = "#" + e;
} else e = e.replace(/#(?:(.)(.)(.)$)?/, "#FF$1$1$2$2$3$3").toUpperCase();
} else {
var r = Ze.indexOf(e.toUpperCase());
r >= 0 && (e = Ze[r + 1]);
}
return e;
}
function ea(e) {
return e._path || (e._path = []);
}
function aa(e) {
return e && (e = e % Ge || Ge, 0 > e && (e += Ge)), e / Ge * 4095;
}
function ta(e) {
var a = [];
this.addColorStop = function(e, t) {
a.push(e + Ve(t));
}, this.toString = function() {
return e + a.sort().join(",");
};
}
function wa(e, a) {
var t = _t(e, a);
oe(t), e && a && (Fa(e, a), qn(t, e, a), bi(e, a, na), Mi());
}
function Fa(e, a) {
va = e, ca = a, na = Math.min(va, ca) / 6 | 0, ia = 0 | Math.min(na / 4, 20), la = 2.18 * na | 0, 
Wt(va, ca, na, ia), sa && Ja(sa);
}
function xa(e) {
ve(ga), ba(e);
for (var a = e.children, t = a.length; t--; ) a[t].scale = br;
Ja(sa = e);
}
function Sa(e, a) {
var t = -1 == e ? sa : sa.children[e];
Ca(t, a);
}
function Ca(e, a) {
function t(e) {
Jt(), ve(ga), a && a(e), e && Ma();
}
Jn(e, t);
}
function Ma(e) {
for (e = e || sa; e; ) {
if (e.parent && !e.parent.id) {
S(e.data);
break;
}
e = e.parent;
}
}
function ba(e) {
return e.loaded === !1 && (e.loaded = !0, Ia(e, x(e.data))), e;
}
function Ta(e) {
this.id = da++, Ia(this, e);
}
function Ia(e, a) {
e.data = a;
var t = e.children = [], r = a.children;
if (r) for (var n = 0, i = r.length; i > n; n++) {
var l = new Ta(r[n]);
l.parent = e, t.push(l);
} else a.children = [];
}
function Da(e, a) {
var t = sa.children, r = t[a], n = e >= 0 && t[e];
n ? (t.splice(e, 1), sa.data.children.splice(e, 1)) : (n = ha.node, ha = null), 
n.parent = r, sa.id || ba(r), r.children.push(n), r.data.children.push(n.data), 
sa.id ? Ma() : (C(n.data), Ma(r)), n.x = -100, Ra(a > e ? a - 1 : a);
}
function Aa(e, a) {
var t = sa.children, r = sa.data.children, n = t[e], n = (t.length, e >= 0 && t[e]);
e == a ? (t.push(t.shift()), r.push(r.shift())) : e + 1 == a ? (t.unshift(t.pop()), 
r.unshift(r.pop())) : n ? (t.splice(e, 1), r.splice(e, 1), a > e && a--, t.splice(a, 0, n), 
r.splice(a, 0, n.data)) : (n = ha.node, ha = null, n.parent = sa, t.splice(a, 0, n), 
r.splice(a, 0, n.data)), Ma(), Ja(sa);
}
function ka(e, a) {
var t = JSON.parse(JSON.stringify(sa.children[e].data));
Pa(t, a);
}
function Pa(e, a, t) {
function i(t) {
t && (n.splice(a, 0, r), sa.data.children.splice(a, 0, e), Ja(sa));
}
console.log("add child:", a, e.title);
var r = new Ta(e), n = sa.children;
t = t || ma || [ sa.x, sa.y ], r.x = t[0], r.y = t[1], r.scale = .3, r.parent = sa, 
(a >= n.length || null == a) && (a = n.length), e.title ? i(1) : Ca(r, i);
}
function Oa(e, a) {
e >= 0 && (a.node = Ba(e)), ua.unshift(a), a.pack();
}
function Ea() {
return ua[1] && ua[1].pack(), ha = ua.shift();
}
function Ba(e) {
var a = sa.children;
if (e >= 0 && e < sa.children.length) {
var r = (new Date(), a.splice(e, 1)[0]);
return sa.data.children.splice(e, 1), sa.id || C(r.data), hr(r), Ma(), Ja(sa), Ma(), 
r;
}
return -2 == e ? (r = ha.node, ha = null, r) : void 0;
}
function Ra(e) {
var a = sa, t = a.children[e], r = na << 1;
ur(a.children, ma, t), a.id ? ar(a.parent, -r, -r, Mr) : ba(t), Na(sa = t, a);
}
function ja() {
var e = sa, a = e.parent;
return a.id ? (ar(a.parent, 0, -na, Mr), ur(e.children, ma), void Na(sa = a, e)) : Mi();
}
function Na(e, a) {
function T() {
var t = new Date(), r = Math.min(new Date() - S, F) / F;
w == r && (console.log("no rate changed!!!"), r = 1), w = r;
var i = u + p * w, l = d + g * w, o = s + m * w, v = (c + y * w) / 2, f = v * Math.cos(o), h = -v * Math.sin(o);
if (ar(e, i - f, l - h, M), ar(a, i + f, l + h, b), j(new Date() - t), 1 == w) {
clearInterval(C);
var x = n.indexOf(a);
x >= 0 && n.splice(x, 1), dr(n, ma, a == e.parent);
}
}
var t = [ e.x, e.y ], r = [ a.x || 0, a.y || 0 ], n = e.children.concat(), i = n.length;
for (e.hit = 0, Ja(e); i--; ) {
var l = n[i];
l != a && (l.animStart = 0, l.alpha = 0);
}
a == e.parent && (ar(a, 0, -na, Mr), a.hit = -1);
var o = [ e.animX[1], e.animY[1] ], v = [ a.animX[1], a.animY[1] ], c = be(t, r), f = be(o, v), s = Ha(t, r), h = Ha(o, v);
Math.abs(s - h) > Math.PI && (s += s > h ? -oa : oa);
var u = (t[0] + r[0]) / 2, d = (t[1] + r[1]) / 2, p = (o[0] + v[0]) / 2 - u, g = (o[1] + v[1]) / 2 - d, m = h - s, y = f - c, w = 0, F = (Math.abs(m / oa) + .5) * Sr, x = Math.min(F / 8, Fr), S = new Date() - x, C = setInterval(T, x), M = e.root ? Cr : 1, b = a == e.parent ? Mr : br;
T();
}
function Ya(e, a) {
var t = new Date();
if (ya) {
var r = +new Date(), n = Math.min(r - ya[0], xr) / xr, i = ya[3] + n * (ya[2] - ya[1]), l = i - ya[3] + ya[1];
sa.angle = i, ya[0] = r, clearInterval(ya[4]);
} else i = sa.angle || 0, ya = [ new Date() ], l = Ha(ma, e);
var o = ya[2] = Ha(ma, a), v = Fr;
Math.abs(l - o) > Math.PI && (l += l > o ? -oa : oa), v = Math.min(v, xr / (Math.abs(l - o) / .01)), 
ya[0] -= v, ya[1] = l, ya[3] = i, ya[4] = setInterval(_a, v), j(new Date() - t, "routeChild"), 
_a();
}
function _a() {
var e = new Date(), a = Math.min(+new Date() - ya[0], xr) / xr, t = ya[3] + a * (ya[2] - ya[1]);
return t == sa.angle && (a = 1, console.log("no angle changed!!!")), sa.angle = t, 
Ja(sa, ma), j(new Date() - e, "routeAnimator"), 1 == a ? (ya = clearInterval(ya[4]), 
!0) : void 0;
}
function Ja(e, a) {
ma = a || $a(sa);
var t = ma[0], r = ma[1], n = ma[2], i = e.angle || 0, l = e.children, o = l.length, v = ma[3], c = 0, f = t, s = r;
if (v) {
f && (f -= na, s -= na), i += oa * (e.id ? .25 : .75), c = La(o, i), i += c * v, 
i %= oa, c %= o, 0 > c && (c += o);
var h = ma[4], u = ma[5], d = i - v / 2;
0 != c && (l = l.slice(c).concat(l.slice(0, c)));
} else v = oa / (o || 4), i %= oa, h = d = o ? i + v / 2 : i, u = h + oa;
e.hit = 0, ar(e, f, s, e.id ? 1 : Cr, 1), or(e, t, r, n, h, u, d, v);
for (var p = 0; o > p; p++) {
var g = t + n * Math.cos(i), m = r - n * Math.sin(i), y = l[p];
i > u && h && (v = (h + oa - u) / (o - p), h = 0), i += v, y.hit = 2 * c + 1, ar(l[p], g, m, br, 1), 
++c == o && (c = 0);
}
}
function La(e, a) {
var t = ma[3], r = ma[4], n = r - a;
return 0 | n / t;
}
function $a(e) {
var a = e.children.length, t = br * na;
if (e.id) {
if (5 > a || la * Math.sin(Math.PI / a) - t > t / 3) return [ va / 2, ca / 2, la ];
r = va - t, n = ca - t, ca > va ? n -= t : r -= t, i = Math.min(r - t, n - t), l = 2 * Math.asin(1.5 * t / i), 
v = Math.PI / 2 - Math.asin((va - r + t) / i), c = Math.PI + Math.asin((ca - n + t) / i);
} else var r = 0, n = 0, i = Math.min(va - 2 * t, ca - 2 * t), l = 2 * Math.asin(1.5 * t / i), o = Math.asin(t / i), v = 1.5 * Math.PI - o, c = oa + o;
var f = [ r, n ];
return f.push(i), f.push(l), f.push(v), f.push(c), f;
}
function Ga(e, a, t) {
var r = [ e, a ], n = ma[2], i = n + na, l = be([ sa.x, sa.y ], r, i);
if (na >= l) return 0;
if (ma.length > 4 && (l = be(ma, r, i)), i > l) {
var o = Math.abs(l - n);
if (na > o) {
for (var v = sa.children, c = v.length, f = na * br, s = t ? Math.max(na >> 1, ia) : ia, h = 0; c > h; h++) {
var u = v[h], d = [ u.x, u.y ], p = be(d, r, f);
if (f >= p) return 2 * h + 1;
}
if (s += 16, s > o && (s = Xa(n, c, s, r))) return s;
}
} else {
var g = sa.parent;
if (g && be([ g.x, g.y ], r, na * Mr) < i) return -1;
if (be([ va, 0 ], r, Ir * na) < i) return -2;
}
var m = ca - e;
if (na > m) {
if (na > e) return -3;
if (na > va - e) return -4;
}
}
function Xa(e, a, t, r) {
var n = Ha(ma, r), i = 2 * Math.asin(t / e), l = sa.angle || 0, o = ma[3], v = a;
if (o) {
var c = ma[5], f = La(a, l += oa / 4);
l += f * o - o / 2, f--, l %= oa, v = Math.floor((c - l) / o);
} else a ? (o = oa / a, l += o / 2) : (o = oa / 4, v = 4);
for (var s = 0; v > s; s++) {
var h = Math.abs(n - l) % oa;
if (i > h) return f && (s += f, s %= a, 0 > s && (s += a)), 2 * s + 2;
l += o;
}
}
function Ha(e, a) {
var t = a[0] - e[0], r = a[1] - e[1], n = Math.acos(t / Math.sqrt(t * t + r * r)) || 0;
return r > 0 && (n = oa - n), n;
}
function at(e, a, t, r, n, i) {
switch (e) {
case -1:
Ua = [ n, i ], Va && (Va = Va.cancel()), Za = null, Qa = Ga(t, r), Ka = Qa >= 0 && (1 & Qa) + 1, 
-2 == Qa && (Va = Ea(), Va && (Va.index = -2, Va.move(n, i, Qa)));
var l = new Date();
Er > l - et ? 2 == Ka && tt(2) : 1 == Ka && tt(1), et = l;
break;
case -2:
if (null != Va) {
var o = Ga(n, i, !0);
Va.move(n, i, o), Za = o;
} else (Qa > 0 || null == Qa) && Ya(Ua, Ua = [ n, i ]);
break;
case -3:
Va && nt(a, n, i);
break;
case 0:
if (console.log("longpress"), Qa > 0 && 1 & Qa) {
var v = Qa >> 1;
Va = ra(v), Va.index = v;
}
break;
case 1:
1 != Ka && tt(1);
break;
case 2:
2 != Ka && tt(2);
break;
case 3:
tt(e);
}
}
function tt(e) {
if (console.log("tap child:" + Qa, e), Qa > 0) if (1 & Qa) {
var a = Qa >> 1;
1 == e ? Ra(a) : Sa(a);
} else console.log("add event:" + Qa), rt(Qa >> 1); else 0 == Qa ? e > 1 && Sa(-1) : -1 == Qa && ja();
}
function rt(e) {
var a = "", t = {
title: a,
children: []
};
Pa(t, e);
}
function nt() {
var r = Va.index;
if (-2 == Za) console.log("put past board"), Oa(r, Va); else if (null == Za) Va = -2 == r ? Oa(r, Va) : Va.cancel(); else if (Va = Va.cancel(), 
0 == Za) ka(r, r + 1); else if (Za > 0) {
var n = Za >> 1;
1 & Za ? r != n && Da(r, n) : Aa(r, n);
} else if (-1 == Za) {
var i = Ba(r);
ja(), Pa(i.data);
}
}
function ct(e, a) {
lt = e, ot = a, vt = e / 3;
}
function ft(e) {
var a = e.scale || 1, t = it(e), r = t[0];
if (t.scale != a || e.dirty) {
console.log("redraw node canvas!" + [ e.scale, e.id, r.nativeId, e.data.title ]);
var n = lt * a | 0, i = n << 1, l = 6;
r.width = i, r.height = i;
var o = r.getContext("2d"), v = e.data.fill || "#4cd4bc", c = o.createLinearGradient(0, 0, i, i);
c.addColorStop(0, "rgba(153,153,153,0.3)"), c.addColorStop(.4, "rgba(238,238,238,0.3)"), 
c.addColorStop(1, "rgba(153,153,153,0.3)"), o.save();
try {
t.scale = a, e.dirty = !1, o.fillStyle = v, o.clearRect(0, 0, i, i), o.strokeStyle = c, 
o.lineWidth = l, o.beginPath(), o.arc(n, n, n - l, 0, 2 * Math.PI), o.fill(), o.stroke(), 
o.textAlign = "center", o.fillStyle = st(v);
var f = e.data.icon, s = e.data.title, h = vt * a * (s.length > 5 ? .9 : 1) | 0, u = h;
if (a > 1) {
h /= a, u /= a;
var d = yt(o, s, h, n, 2), p = d.length * u, g = 1.42 * n + u + p / 2;
o.textAlign = "left";
} else var d = yt(o, s, h, 1.68 * n, 3), p = d.length * u, g = n + p / 2;
for (var m = d.length; m--; ) o.fillText(d[m], n, g), g -= u;
f && li(o, f, n - .7 * h, g - 1.4 * h, 1.4 * h);
} finally {
o.restore();
}
}
return r;
}
function st() {
return "#FFF";
}
function ht(e) {
var a = new Image(), t = ft(e), r = it(ht)[0], n = lt / 2, i = r.width = r.height = n << 1, l = r.getContext("2d");
return l.clearRect(0, 0, i, i), l.drawImage(t, 0, 0, t.width, t.height, 0, 0, i, i), 
a.src = r.toDataURL("image/png"), a.width = a.height = i, a;
}
function ut(e, a) {
var t = -1 == a, r = lt / 3, n = it(ut), i = n[0];
if (n[1] != r || n[2] != e || n[3] ^ t) {
console.log("redraw home icon!"), n[1] = r, n[2] = e, n[3] = t;
var l = i.getContext("2d"), o = 0 | Math.max(.1 * r, 2), v = r + o << 1, c = r + o, f = c, s = r / 1.5;
i.width = i.height = v, l.clearRect(0, 0, v, v), l.beginPath(), l.lineWidth = o, 
l.strokeStyle = a ? "#933" : e ? "#999" : "#ccc", l.arc(c, f, r, 0, 2 * Math.PI), 
l.stroke(), l.lineWidth = o, l.moveTo(c, f - s), l.lineJoin = "round", l.lineTo(c - .9 * s, f - r / 5), 
l.lineTo(c - .9 * s, f + r / 2), l.lineTo(c - .3 * s, f + r / 2), l.lineTo(c - .3 * s, f + s / 8), 
l.lineTo(c + .3 * s, f + s / 8), l.lineTo(c + .3 * s, f + r / 2), l.lineTo(c + .9 * s, f + r / 2), 
l.lineTo(c + .9 * s, f - r / 5), l.closePath(), l.stroke();
}
return i;
}
function dt(e, a, t) {
a = !!a;
var r = -2 == t, n = lt / 3, i = it(dt), l = i[0];
if (i[1] != n || i[2] != a || i[3] ^ r || i[4] != e) {
console.log("redraw pasteBoard!"), i[1] = n, i[2] = a, i[3] = r, i[4] = e;
var o = l.getContext("2d"), v = 0 | Math.max(.1 * n, 2), c = n + v << 1;
if (l.width = l.height = c, o.clearRect(0, 0, c, c), o.beginPath(), o.lineWidth = v, 
o.strokeStyle = t ? "#933" : a ? "#999" : "#ccc", o.arc(n + v, n + v, n, 0, 2 * Math.PI), 
o.stroke(), e) o.drawImage(e, 0, 0, e.width, e.height, v, v, c - v - v, c - v - v); else {
o.strokeStyle = "#ccc";
var f = .45 * n, c = .9 * n, h = 1.1 * n;
n = .1 * n, o.save();
try {
o.translate(f + n / 2, f), o.beginPath(), o.arc(n, n, n, Math.PI, 1.5 * Math.PI), 
o.arc(c - n, n, n, 1.5 * Math.PI, 0), o.arc(c - n, h - n, n, 0, .5 * Math.PI), o.arc(n, h - n, n, .5 * Math.PI, 1 * Math.PI), 
o.lineTo(0, n), o.stroke(), o.beginPath(), o.translate(2.5 * n, 2.5 * n), o.moveTo(c - n - n / 2, 0), 
o.arc(c - n, n, n, 1.5 * Math.PI, 0), o.arc(c - n, h - n, n, 0, .5 * Math.PI), o.arc(n, h - n, n, .5 * Math.PI, 1 * Math.PI), 
o.lineTo(0, h - n - n / 2), o.stroke();
} finally {
o.restore();
}
}
}
return l;
}
function gt() {
return mt(0, .8 * lt);
}
function mt(e, a) {
a = a || ot;
var t = it(pt[e] || mt), r = t[0];
if (t[1] != e || t[2] != a) {
console.log("redraw place holder!"), t[1] = e, t[2] = a, e && (a *= 1.2);
var n = 2 * a, i = .1 * a, l = a - i, o = r.getContext("2d");
r.width = n, r.height = n, o.strokeStyle = "#ccc", o.lineWidth = i, o.lineCap = "round", 
o.beginPath(), e ? (o.arc(a, a, l, 0, 2 * Math.PI), o.stroke(), o.fillStyle = 2 == e ? "#0EE" : "#FFF", 
o.fill()) : (o.arc(a, a, l, 0, 2 * Math.PI), o.stroke(), o.lineWidth = 3 * i, l -= 4 * i, 
o.fillStyle = "#ccc", o.strokeStyle = "#FFF", o.fill(), o.beginPath(), o.moveTo(a - l, a), 
o.lineTo(a + l, a), o.moveTo(a, a - l), o.lineTo(a, a + l), o.stroke());
}
return r;
}
function yt(e, a, t, r, n) {
e.font = t + "px " + yr;
var i = e.measureText(a).width, l = i / r;
if (l > 1.1) {
var o = [], v = a.match(/\w+|./g), c = v[0];
n > l && (r = Math.min(i / Math.ceil(l), r));
for (var f = 1; f < v.length; f++) {
var s = v[f], h = c + s, i = e.measureText(h).width;
if (i > r) {
if (!(o.length < n - 1)) {
c = c.slice(0, -v[f - 1].length) + "...";
break;
}
o.push(c), c = s;
} else c = h;
}
return o.length > 0 && 1 == c.length ? o[o.length - 1] += c : o.push(c), o;
}
return [ a ];
}
function wt(e) {
var a = it(wt), t = a[0], r = 2 * e;
if (a[1] != e) {
t.width = t.height = r + 1 << 1;
var n = t.getContext("2d");
n.strokeStyle = "rgba(255,189,189,.1)", n.lineWidth = 24;
for (var i = 0; 4 > i; i++) n.beginPath(), n.arc(r, r, e, 0, 2 * Math.PI, !0), n.stroke(), 
e *= 1.03;
}
return t;
}
function _t() {
return Ft = De(0), Ft.mozOpaque = !0, xt = De(1), xt.mozOpaque = !0, St = qt(xt, !0), 
Ct = qt(Ft, !0), null == Ct.nativeId && (document.body.appendChild(xt), document.body.appendChild(Ft)), 
Ft;
}
function qt(e) {
e.style.cssText = "position:absolute;left:0;top:0;";
var a = e.getContext("2d");
return a.imageSmoothingEnabled ? a.imageSmoothingEnabled = !1 : a.webkitImageSmoothingEnabled && (a.webkitImageSmoothingEnabled = !1), 
a;
}
function Wt(e, a, t, r) {
xt.width = Ft.width = bt = e, xt.height = Ft.height = Tt = a, Mt = t, It = .8 * Mt, 
kt = Math.min(r >> 2, 126), ct(t, r), Jt();
}
function Jt() {
Yt = null, O($t);
}
function Lt() {
O($t);
}
function $t() {
if (null != Pt) {
var a = [], t = [], r = [], n = Ut(a, t, r), i = a.length < 2, l = i && Qt();
l ? n = !0 : l = Pt, vr.apply(r, l), a == Yt ? (Ct.clearRect(0, 0, bt, Tt), i && (cr.apply(Ct, l), 
Kt(Ct, t))) : (St.clearRect(0, 0, bt, Tt), St != Ct && (Ct.clearRect(0, 0, bt, Tt), 
Yt = a + ""), i ? Kt(Ct, t) : (cr.apply(St, l), Kt(St, t)), xt.commit && xt.commit(), 
console.log("commit back canvas!!")), fr(Pt[0]), Kt(Ct, r), Ct.globalAlpha = 1;
for (var o = At.length; o--; ) At[o]() && (n = !0);
return n;
}
}
function Ut(e, a, t) {
var r = Vt(), n = Pt[0], i = n.parent, l = i && i.id;
Gt += +new Date();
var o = n.children, v = Bt && Bt.hit || null, c = dt(jt, Bt, v), f = o.length;
for (e.push([ -1, -2, 0 ].indexOf(v)), a.push([ 1, c, bt - It, It - c.height ]), 
l ? er(i, a) && (r = !0) : (c = ut(Bt, v), a.push([ 1, c, It - c.width, It - c.height ])), 
Xt += +new Date(), er(n, a) && (r = !0), r || e.push(n.id, n.x); f--; ) {
var s = o[f];
er(s, t) && (r = !0);
}
for (Ht += +new Date(), f = Dt.length; f--; ) {
var s = Dt[f];
er(s, t) ? r = !0 : 0 == s.alpha && Dt.splice(f, 1);
}
return r;
}
function Qt() {
if (Ot) {
var e = new Date() - Et;
if (wr > e) {
var a = e / wr;
if (1 > a) {
for (var t = [ Pt[0] ], r = 1; r < Pt.length; r++) t.push(pr(Pt[r], Ot[r], a));
return Ot = t;
}
Ot = 0;
}
}
}
function Kt(e, a) {
for (var t = a.length; t--; ) {
var n = a[t], i = n.shift(), l = n.length;
if (e.globalAlpha = i, 9 == l) a[t] = n.slice(5, 9); else {
var o = n[0];
a[t] = [ n[1], n[2], o.width, o.height ];
}
for (;--l > 0; ) n[l] = 0 | n[l];
e.drawImage.apply(e, n);
}
}
function Vt() {
for (var e = Rt.length; e--; ) Rt[e]() && Rt.splice(e, 1);
return Rt.length;
}
function er(e, a) {
if (!(e.alpha < .1)) {
var t = e.alpha || 1, r = ir(e), n = (e.scale || 1) * Mt, i = r[0], l = r[1], o = r[2], v = ft(e);
if (Bt && e.hit >= 0 && e.hit == Bt.hit) if (Bt.id != e.id) {
var c = wt(n), f = c.width / 2;
a.push([ t, c, i - f, l - f ]), a.push([ t, v, i - n, l - n ]);
} else {
var f = Mt * br;
a.push([ t, v, 0, 0, n *= 2, n, i - f, l - f, f *= 2, f ]);
} else if (1 == o) a.push([ t, v, i - n, l - n ]); else {
var f = n * o;
a.push([ t, v, 0, 0, n *= 2, n, i - f, l - f, f *= 2, f ]);
}
return e.animStart;
}
}
function ar(e, a, t, r, n) {
if (e.animStart) var i = Math.min(1, (new Date() - e.animStart) / wr), l = gr(e.animAlpha, i), o = gr(e.animScale, i), v = gr(e.animX, i), c = gr(e.animY, i); else v = e.x || 0, 
c = e.y || 0, l = null == e.alpha ? 1 : e.alpha, o = e.scale || 1;
var f = null == n ? l : n, s = r || o;
return a == v && t == c && l == f && o == s ? (e.x = a, e.y = t, e.alpha = f, void (e.scale = s)) : (e.animAlpha = [ l, f ], 
e.animScale = [ o, s ], e.animX = [ v, a ], e.animY = [ c, t ], e.animStart = new Date(), 
void Lt());
}
function ir(e) {
if (e) {
if (e.animStart) {
var a = Math.min(1, (new Date() - e.animStart) / wr), t = gr(e.animScale, a), r = gr(e.animX, a), n = gr(e.animY, a);
e.x = r, e.y = n, e.alpha = gr(e.animAlpha, a), 1 == a ? (e.animStart = null, e.animScale = null, 
e.animX = null, e.animY = null, e.animAlpha = null, e.scale = Math.max(t, br), t = 1) : t /= e.scale || 1;
} else var r = e.x, n = e.y;
if (Bt && e.scale < 1 && Bt.id != e.id) {
var i = Pt[3], l = Pt[1], o = Pt[2], v = Bt.x - r, c = Bt.y - n, f = Math.min(i - Mt, 2 * Mt), s = Math.sqrt(v * v + c * c), h = Bt.x - l, u = Bt.y - o, d = Math.sqrt(h * h + u * u);
if (d > Mt && f > s && Math.abs(d - i) < f) {
var p = l - r, g = o - n, m = g / i, y = p / i, w = v * g - c * p > 0 ? 1 : -1, F = l + h / d * i - r, x = o + u / d * i - n;
s = (1 - s / f) * Math.sqrt(F * F + x * x), r -= m * s * w, n += y * s * w;
}
}
return [ r, n, t || 1 ];
}
}
function lr(e) {
function o() {
var e = Ct.globalAlpha;
Ct.globalAlpha /= 3, Ct.drawImage(i, a - l, t - l), Ct.globalAlpha = e;
}
var a = e.x, t = e.y, i = (new Date(), e.scale, ht(e)), l = i.width / 2;
return ar(e, e.x, e.y, Tr, Tr), At.push(o), Bt = {
id: e.id
}, Lt(), {
move: function(e, r, n) {
null == Bt && (Bt = {}, At.push(o), jt == i && (jt = null)), a = e, t = r - l / 2, 
Bt.hit = n, Bt.x = e, Bt.y = r, Lt();
},
pack: function() {
mr(At, o), jt = i, Bt = null, Jt();
},
cancel: function() {
Bt = null, ar(e, e.x, e.y, br || .8, 1), mr(At, o), Lt();
}
};
}
function or() {
Et = new Date(), Ot = Pt, Pt = arguments, Lt();
}
function vr(e, a, t, r, n, i, l, o) {
var v = this, c = mt(null == Bt ? 0 : 1), s = c.width / 2, h = Bt && Bt.hit, u = h && 1 & ~h && Mt;
for (a -= s, t -= s; i > l; ) {
var d = a + r * Math.cos(l), p = t - r * Math.sin(l, u);
v.push(u && Math.abs(d - Bt.x) < u && Math.abs(p - Bt.y) < u ? [ 1, mt(2), d, p ] : [ 1, c, d, p ]), 
l += o;
}
}
function cr(e, a, t, r, n, i) {
this.strokeStyle = "#ddd", this.lineWidth = kt, this.beginPath(), this.arc(a, t, r, -i, -n, !1), 
this.stroke(), sr(this, e, e.parent);
}
function fr(e) {
Ct.strokeStyle = "#ddd", Ct.lineWidth = kt / 2, sr(Ct, e, e.children[0], Mt);
}
function sr(e, a, t, r) {
if (t && t.id) {
var n = a.x, i = a.y, l = t.x, o = t.y;
r && (r = 1 - r / (i == Pt[2] ? Pt[3] : be([ n, i ], [ l, o ])), n = pr(n, l, r), 
i = pr(i, o, r)), e.beginPath(), e.moveTo(n, i), e.lineTo(l, o), e.stroke();
}
}
function hr(e) {
var a = Dt.indexOf(e);
0 > a && Dt.push(e), ar(e, e.x, e.y, .1, 0);
}
function ur(e, a, t) {
for (var r = a[0], n = a[1], i = e.length, l = t && t.parent.id ? 2 : .75; i--; ) {
var o = e[i];
t != o && ar(o, pr(o.x, r, l), pr(o.y, n, l), l, 0);
}
for (i = Dt.length; i--; ) e.indexOf(Dt[i]) >= 0 && (console.warn("re hide node"), 
Dt.splice(i, 1));
Dt = Dt.concat(e);
}
function dr(e, a) {
for (var r = a[0], n = a[1], i = .6, l = e.length; l--; ) {
var o = e[l], v = o.animX && o.animX[1] || o.x, c = o.animY && o.animY[1] || o.y, f = .8;
o.animStart = 0, o.alpha = .1, o.x = pr(v, r, i), o.y = pr(c, n, i), o.scale = f, 
ar(o, v, c, f, 1);
}
}
function pr(e, a, t) {
return e * t + a * (1 - t);
}
function gr(e, a) {
return pr(e[1], e[0], Math.sqrt(a));
}
function mr(e, a) {
var t = e.indexOf(a);
t >= 0 && e.splice(t, 1);
}
function Xr(e, a, t, r, n) {
Nr = a;
var i = n / 2.5, l = .618 * t, o = i + 1.309 * l, v = n - 1.618 * l, c = n - 1.309 * l, f = n - .309 * l;
Jr = r, Lr = l >> 1, Wr = -1, Gr = e(Hr, null, 0, t, Jr, i)(Ur, Qr, 0, i, Jr, i + l)(Kr, Zr, 0, o, Jr, v)(Vr, en, 0, c, Jr, f), 
zr(Nr);
}
function Hr(e, a, t) {
e.fillStyle = "#FFF", e.fillRect(0, 0, a, t);
var r = t / 3, a = 2 * r, n = ft(Nr), i = Jr / 2, l = t / 2;
if (Wr >= 1) {
var o = jr[Yr] || jr[0], v = _r, c = .7 * r, f = .3 * r, s = 1.1 * r, h = [], u = Nr.data.fill || o[v = 0], d = 7 * (v / 7 | 0);
h.push(u), e.fillStyle = u, e.drawImage(n, i - c, l - c, 2 * c, 2 * c);
for (var p = 0; 6 > p; p++) {
var g = Math.PI * p / 3, m = i + s * Math.cos(g), y = l + s * Math.sin(g);
2 == Wr && (u = o[d + ++v % 7], e.fillStyle = u, h.push(u)), e.beginPath(), e.arc(m, y, f, 0, 2 * Math.PI, !1), 
e.fill();
}
} else e.drawImage(n, i - r, l - r, 2 * r, 2 * r);
Nr.childColors = h;
}
function zr(e) {
var a = e.data.fill || "", t = a.toUpperCase();
if (qr >= 0 && (_r = jr[qr].indexOf(t), _r >= 0)) return void (Yr = qr);
Yr = 0, _r = -1;
for (var r = jr.length; r; ) if (_r = jr[--r].indexOf(t), _r >= 0) {
Yr = qr = r;
break;
}
}
function Ur(e, a, t) {
Se(e, 0, t, Lr, a - Lr, Rr, qr);
}
function Qr(e, a, t) {
-1 == e && (qr = Math.min((t - Lr) / (Jr - Lr - Lr) * Rr.length | 0, Rr.length - 1), 
Gr(Ur), Gr(Kr));
}
function Kr(e, a, t) {
e.fillStyle = "#FFF", e.fillRect(0, 0, a, t), $r = t;
for (var r = jr[qr], n = t / 4, i = (a - Lr - Lr) / 7, l = .309 * Math.min(n, i), o = Yr == qr ? _r : -1, v = 0, c = 0, f = n / 2; 4 > c; c++) {
for (var s = 0, h = Lr + i / 2; 7 > s; s++, v++) {
var u = e.fillStyle = r[v];
o == v && (e.strokeStyle = u, e.lineWidth = .1 * l, e.beginPath(), e.arc(h, f, 1.2 * l, 0, 2 * Math.PI, !1), 
e.stroke()), e.beginPath(), e.arc(h, f, l, 0, 2 * Math.PI, !1), e.fill(), h += i;
}
f += n;
}
}
function Zr(e, a, t, r) {
if (1 == e) {
t = Math.min(6, 0 | (t - Lr) / (Jr - Lr - Lr) * 7), r = 0 | (4 * r - .1) / $r;
var n = 7 * r + t, i = jr[qr];
n >= 0 && (qr != Yr || _r != n) && (Yr = qr, _r = n, Nr.data.fill = i[n], Nr.dirty = !0, 
Gr(Kr), Gr(Hr));
}
}
function Vr(e, a, t) {
if (0 > Wr) Se(e, 0, t, Lr, a - Lr, [ "批量修改子节点颜色" ], -1); else {
var r = [ "重置", "设置同色", "自动变色" ];
Se(e, 0, t, Lr, a - Lr, r, Wr);
}
}
function en(e, a, t) {
1 == e && (0 > Wr ? (Wr = 0, Gr(Vr)) : (Wr = Math.min(0 | 3 * (t - Lr) / (Jr - Lr - Lr), 2), 
Gr(Hr), Gr(Vr)));
}
function vn(e, a, t, r, n) {
function u(e, a, t) {
e.fillStyle = "#ddd", e.fillRect(0, 0, a, t);
}
e(u, function() {}, 0, t, r, n), nn = a, ln = nn.data;
var i = t >> 3, l = t + i, o = 0 | .8 * t, v = l + o + i, c = n - v - i, f = .6 * o | 0, s = .3 * o | 0, h = [ "left:", i, "px;width:", r - i - i, "px;border:0;margin:0;padding:0;position:absolute;z-index:9;display:block;font-size:" ];
if (null == tn) {
var d = document.body;
tn = document.createElement("input"), rn = document.createElement("textarea"), tn.placeholder = "输入显示标题", 
rn.placeholder = "添加详细注备", tn.setAttribute("style", h.concat(f, "px;top:", l, "px;height:", o, "px").join("")), 
rn.setAttribute("style", h.concat(s, "px;top:", v, "px;height:", c, "px").join("")), 
d.appendChild(tn), d.appendChild(rn);
} else {
if ("block" == tn.style.display) return;
tn.style.display = "block", rn.style.display = "block";
}
tn.value = ln.title || "", rn.value = ln.content || "";
}
function Sn(e, a, t, r, n) {
var i = n / 3.2, l = .618 * t, o = i + l, v = i + 1.2 * l, c = n;
gn = c - v, dn = l >> 1, un = r, mn = 0, cn = a, pn = e(Cn, bn, 0, t, un, i)(Tn, In, 0, i, un, o)(Dn, An, 0, v, un, c);
}
function Cn(e, a, t) {
xn = t, e.fillStyle = "#FFF", e.fillRect(0, 0, a, t);
var r = t / 3, a = 2 * r, n = ft(cn), i = un / 2, l = t / 2;
e.drawImage(n, i - r, l - r, a, a), Mn(e, r);
}
function Mn(e, a) {
var t = cn.data.icon;
if (t) {
var a = xn / 7, r = xn / 3, n = 2 * a, i = r - n, l = .2 * a;
e.lineWidth = "2", e.strokeStyle = "#ddd", e.beginPath(), e.moveTo(0, i), e.arc(2 * n - a, i + a, a, -Math.PI / 2, Math.PI / 2, !1), 
e.lineTo(0, r), e.stroke(), li(e, t, l, i + l, n - l - l), e.strokeStyle = "#E66", 
e.lineWidth = "4", e.beginPath(), l *= 3, i += l, r -= l, a = n + n - l, e.moveTo(n + l, i), 
e.lineTo(a, r), e.moveTo(n + l, r), e.lineTo(a, i), e.stroke();
}
}
function bn(e, a, t, r) {
var n = xn / 3, i = xn / 7, l = 2 * i, o = n - l;
cn.data.icon && 2 * l >= t && r >= o && n >= r && (cn.data.icon = "", cn.dirty = !0, 
pn(Cn));
}
function Tn(e, a, t) {
var r = fn;
if (hn) {
r = r.concat(hn);
var n = !0, i = function(e, a, t, r, i) {
Ce(e, a, t, r, i), n && sn && (n = !1, e.fillStyle = "#ccc", Ce(e, a, t, r + (i - r) / 3, i));
};
}
Se(e, 0, t, dn, a - dn, r, sn, i);
}
function In(e, a, t) {
if (1 == e) {
var n = hn ? 3 : 2;
sn = Math.min(0 | (t - dn) * n / (un - dn - dn), n - 1), 1 == sn && (hn = 0), pn(Tn), 
pn(Dn);
}
}
function Dn(e, a, t) {
e.fillStyle = "#FFF", e.fillRect(0, 0, a, t), a -= dn, wn = 0;
{
var r = dn / 2, n = t >> 3, i = a >> 3;
.8 * Math.min(n, i) | 0;
}
if (i -= r, 1 == sn) {
var o = ri(a, t);
e.drawImage(o, r, 0);
} else if (0 == sn) {
var o = ii(a, t);
e.drawImage(o, r, 0);
} else {
var v = pi.indexOf(hn), o = ci(v, a), c = o.height, f = t - c - dn;
if (mn >= 0 || f >= 0) e.drawImage(o, r, 0); else {
if (f > mn) {
var s = f - mn;
if (-2 != yn) {
s = (.9 * s | 0) - t / 1e3, mn = f - s;
var h = !0;
}
f > mn ? wn = -f + 50 * Math.log((f - mn) / 50 + 1) : (mn = f, wn = -mn);
} else wn = -mn;
var u = c - wn;
e.drawImage(o, 0, wn, a, u, r, 0, a, u);
}
if (c > t) {
var d = e.createLinearGradient(0, t - n, 0, t);
d.addColorStop(0, "rgba(255,255,255,0.01)"), d.addColorStop(.1, "rgba(255,255,255,0.2)"), 
d.addColorStop(.5, "rgba(255,255,255,0.8)"), d.addColorStop(1, "rgba(255,255,255,1)"), 
e.fillStyle = d, e.fillRect(0, t - n, a, n);
}
}
return h;
}
function An(e, a, t, r, n, i) {
if (yn = e, 1 == e) if (1 == sn) n = 0 | Math.min(3 * (n - dn / 2) / (un - dn), 2), 
i = 0 | Math.min(3 * i / gn, 2), hn = pi[3 * i + n], mn = 0, sn = 2, pn(Tn), pn(Dn); else {
if (n -= dn / 2, sn) {
i += wn;
var l = pi.indexOf(hn), o = ui(l, n, i);
} else {
mn = 0;
var o = di(n, i);
}
o && (cn.data.icon = o, cn.dirty = !0, pn(Cn));
} else if (-1 == e) Fn = i; else if (-2 == e) {
var v = Fn - (Fn = .5 * i + .5 * Fn);
mn -= v, pn(Dn);
} else -3 == e && pn(Dn);
}
function qn(e, a, t) {
e.addEventListener("touchstart", Wn, !1), En = a, Bn = t;
}
function Wn() {
0 == On && jn && on();
}
function Jn(e, a) {
kn = e, Pn = Hn(e), Rn = En / 6 | 0, jn = a, Gn(e.data.title ? On : 0);
}
function Ln(e, a, t) {
e.clearRect(e, 0, 0, a, t), Se(e, 0, t, 0, a, Nn, On, zn);
}
function $n(e, a, t) {
if (-1 == e) {
var n = 0 | 4 * t / En, i = Nn.length - 1;
if (n && 0 == On && an(), n >= i) {
var l = JSON.stringify(Pn), o = JSON.stringify(Hn(kn)), v = kn.childColors;
if (v) for (var c = kn.children, f = c.length; f--; ) c[f].data.fill = v[(f + 1) % v.length], 
c[f].dirty = 1;
console.log(v), jn(l != o || v), jn = null;
} else n >= 0 && n != On && Gn(n);
}
}
function Gn(e) {
Yn = Xn(e), e ? (Yn(function(e) {
e.fillStyle = "#FFF", e.fillRect(0, Rn, En, Bn - Rn);
}, null, 0, 0, 1, 0), 1 == e ? Xr(Yn, kn, Rn, En, Bn) : Sn(Yn, kn, Rn, En, Bn)) : vn(Yn, kn, Rn, En, Bn);
}
function Xn(e) {
return On = e, pe()(Ln, $n, 0, 0, En, Rn);
}
function Hn(e) {
var a = e.data;
return {
title: a.title || "",
content: a.content || "",
fill: a.fill,
icon: a.icon
};
}
function zn(e, a, t, r, n) {
if (e.fillRect(r, a, n - r, t - a), n == En) {
var i = t - a, l = n - r, o = r + 3.5 * l / 4, v = (a + t) / 2;
e.beginPath(), e.lineWidth = 5, e.beginPath(), e.arc(o, v, .32 * i, 0, 2 * Math.PI, !1), 
e.stroke();
}
}
function ti(e, a) {
Qn.push(e.split(","));
for (var t = Kn.length >> 3, r = Kn.push.apply(Kn, a.split(",")) >> 3, n = r - t; n--; ) if (1 & t++) {
var i = 8 * t, l = i - 8;
Kn = Kn.slice(0, l).concat(Kn.slice(l, i).reverse()).concat(Kn.slice(i));
}
}
function ri(e, a) {
var t = Un(ri), r = t[0];
if (t[1] != e || t[2] != a) {
t[1] = r.width = e, t[2] = r.height = a;
var n = r.getContext("2d");
n.save();
try {
var i = e / 3, l = 2 * i, o = a / 3, v = 2 * o, c = Math.min(i, o) / 3;
if (n.strokeStyle = "#ddd", n.lineWidth = 4, n.moveTo(0, o), n.lineTo(e, o), n.moveTo(0, v), 
n.lineTo(e, v), n.moveTo(i, 0), n.lineTo(i, a), n.moveTo(l, 0), n.lineTo(l, a), 
n.stroke(), n.textAlign = "left", n.fillStyle = "#3b88c3", ai) {
var f = c / ai;
n.scale(f, f), c = ai, o /= f, i /= f;
}
n.font = (0 | c) + "px " + yr;
for (var s = 0; 9 > s; s++) {
var h = s % 3, u = (s - h) / 3;
ni(n, h * i, u * o, i, o, c, Qn[s]);
}
} finally {
n.restore();
}
}
return r;
}
function ni(e, a, t, r, n, i, l) {
var o = a + r / 2, v = t + n / 2;
e.fillText(l[0], o - i, v), e.fillText(l[1], o - i, v + i), e.fillText(l[2], o, v), 
e.fillText(l[3], o, v + i);
}
function ii(e, a) {
var t = Un(ii), r = t[0];
if (t[1] != e || t[2] != a) {
t[1] = r.width = e, t[2] = r.height = a;
var n = r.getContext("2d"), i = e / 8, l = a / 8;
vi(n, Kn, i, l);
}
return r;
}
function li(e, a, t, r, n) {
if (ai) {
e.save();
try {
var i = n / ai;
e.scale(i, i), e.textAlign = "center", e.fillStyle = "#3b88c3", t /= i, r /= i, 
n = ai, e.font = ai + "px " + yr, hi(e, a, t, r, n);
} finally {
e.restore();
}
} else oi.apply(this, arguments);
}
function oi(e, a, t, r, n) {
e.font = (0 | n) + "px " + yr, e.textAlign = "center", e.fillStyle = "#3b88c3", 
hi(e, a, t, r, n);
}
function vi(e, a, t, r) {
Vn = t, ei = r, e.save();
try {
var n = .8 * Math.min(t, r);
if (ai) {
var i = n / ai;
e.scale(i, i), t /= i, r /= i, n = ai;
}
e.font = (0 | n) + "px " + yr, e.textAlign = "center", e.fillStyle = "#3b88c3";
for (var l = 0; l < a.length; l++) {
var o = l % 8, v = (l - o) / 8;
oi(e, a[l], o * t + (t - n) / 2, v * r + (r - n) / 2, n);
}
} finally {
e.restore();
}
}
function ci(e, a) {
var t = Un(ci), r = t[0], n = Zn[e], i = a / 8 * Math.ceil(n.length / 8);
if (t[1] != e || t[2] != a) {
t[1] = e, t[2] = r.width = a, r.height = i;
var l = r.getContext("2d"), o = a / 8, v = o;
vi(l, n, o, v);
}
return r;
}
function fi(e, a, t, r, n, i) {
e.beginPath(), e.moveTo(a, t + i), e.lineTo(a, t + n - i), e.quadraticCurveTo(a, t + n, a + i, t + n), 
e.lineTo(a + r - i, t + n), e.quadraticCurveTo(a + r, t + n, a + r, t + n - i), 
e.lineTo(a + r, t + i), e.quadraticCurveTo(a + r, t, a + r - i, t), e.lineTo(a + i, t), 
e.quadraticCurveTo(a, t, a, t + i), e.fill();
}
function si(e, a, t, r, n) {
e.save();
try {
e.fillStyle = "#3b88c3", fi(e, t - 1, r - 1, n + 2, n + 2, n / 6), e.fillStyle = "white", 
r += .9 * n, t += n / 2, e.fillText(a, t, r);
} finally {
e.restore();
}
}
function hi(e, a, t, r, n) {
var i = a.charAt(0);
if (i >= "#" && "9" >= i) return si(e, i, t, r, n);
if (i = "�" && 2 == a.length) {
var l = a.charCodeAt(1);
if (l >= 56806 && 56831 >= l) return si(e, String.fromCharCode(-56741 + l), t, r, n);
}
r += .88 * n, t += n / 2, e.fillText(a, t, r);
}
function ui(e, a, t) {
var r = Math.min(a / Vn | 0, 7), n = t / ei | 0;
return Zn[e][8 * n + r];
}
function di(e, a) {
var t = Math.min(e / Vn | 0, 7), r = a / ei | 0;
return Kn[8 * r + t];
}
function Mi() {
Fi = xi * Ar;
for (var e = pe()(Ti, Ii, 0, 0, yi, Fi), a = Fi, t = Ci.children, r = 0; r < t.length; r++) Di(e, t[r], a, a += Fi);
console.log(t.length);
}
function bi(e, a, t) {
xi = t, Si = xi * Dr, yi = e, wi = a, Ci = new gi({
title: "Home",
children: F()
});
for (var r = Ci.children, n = r.length; n--; ) r[n].loaded = !1;
Ci.id = 0, Ci.x = 0, Ci.y = 0;
}
function Ti(e, a, t) {
var r = gt(), n = r.width / 2;
e.fillStyle = "#fff", e.fillRect(0, 0, a, t), e.drawImage(r, a - t, t / 2 - n);
}
function Ii(e, a, t, r) {
var n = Si, i = yi - Fi + n, l = Fi / 2;
console.log([ i, l, be([ t, r ], [ i, l ]), n ]), be([ t, r ], [ i, l ]) <= n && (xa(Ci), 
Pa({}));
}
function Di(e, a, t, r) {
function n(e, t, r) {
var i = mi(n), l = i[0];
(i[1] != a.data.updateTime || i[2] != r) && (i[1] = a.data.updateTime, i[2] = r, 
l.width = t, l.height = r, Ai(l.getContext("2d"), a, t, r)), e.drawImage(l, 0, 0);
}
function i(e) {
1 == e && xa(a);
}
e(n, i, 0, t, yi, r);
}
function Ai(e, a, t, r) {
a.scale = Si / xi;
var n = ft(a), i = a.data, l = r / 8 | 0, o = r / 4;
e.lineWidth = 4, e.fillStyle = "#fff", e.strokeStyle = "#f2f2f2", e.fillRect(0, 0, t, r), 
e.strokeRect(0, 0, t, r), e.drawImage(n, t - r, r / 2 - Si), e.font = "bold " + l + "px " + yr, 
e.fillStyle = "#888", e.textAlign = "left", e.baseLine = 0, e.textBaseline = "middle";
var v = 10;
e.fillText(kr, v, o), e.fillText(Pr, v, 2 * o), e.fillStyle = "#999", e.font = " " + l + "px " + yr;
var c = a.edit || (a.edit = 10 * Math.random() | 0);
e.fillText("节点：" + c + "个 修改" + ((986.756 * c & 63) + 1) + "次", v, 3 * o), v += e.measureText(kr).width, 
e.fillText(ki(i.createTime), v, o), e.fillText(ki(i.updateTime), v, 2 * o);
}
function ki(e) {
function a(e, a) {
return a.length > 1 ? ("000" + e).slice(-a.length) : e;
}
function t(e) {
return e ? (e > 0 ? "-" : e *= -1, "+" + a(e / 60, "00") + ":" + a(e % 60, "00")) : "Z";
}
return e = e ? new Date(e) : new Date(), "YYYY-MM-DD".replace(/([YMDhms])\1*|\.s|TZD$|'[^']+'|"[^"]+"/g, function(r) {
switch (r.charAt()) {
case "Y":
return a(e.getFullYear(), r);
case "M":
return a(e.getMonth() + 1, r);
case "D":
return a(e.getDate(), r);
case "h":
return a(e.getHours(), r);
case "m":
return a(e.getMinutes(), r);
case "s":
return a(e.getSeconds(), r);
case ".":
return "." + a(e.getMilliseconds(), "000");
case "T":
return t(e.getTimezoneOffset());
case "'":
case '"':
return r.slice(1, -1);
default:
return r;
}
});
}
var y, a = function() {
localStorage.clear(), S(s(l.join("\n"))), S(s(o.join("\n"))), S(s(v.join("\n"))), 
S(s(c.join("\n")));
}, l = [ "创意罗盘{2#FF00FF}", "	分享自由{#7A95FF}", "	创意无限{#7A95FF}" ], o = [ "亲情时刻{1#FF3D3D,updateTime=1,icon=⏰}", "	场景闹钟{#7A95FF,icon=⌚}", "		结合位置优化提醒{#CCCC00,icon=🌍}", "			出差场景{}", "		完整作息优化提醒{,icon=💤}", "	倒计时{#FFCC33,icon=⏳}", "		生日{}", "		纪念日{}", "		传统节日{}", "	生活习惯{#52D6EB,icon=🍵}", "		正点吃饭{}", "		熬夜{}", "		用眼{}", "		注意颈椎{}", "		提醒喝水{}", "	亲情实景{#FF9900,icon=🚞}", "		街景实况{}", "		亲情授权{}", "	亲情协作{#0066CC,icon=👥}", "		孩子接送{#FFCC33,icon=👪}", "		路过买菜{#666600,icon=🍆}" ], v = [ "欢迎使用{0#2B8567,icon=🎷,updateTime=1}", "	基本用法{#1FE3BF,icon=🎨}", "		单击展开{#22B59A,icon=🎯}", "		双击编辑{#4CD4BC,icon=📝}", "		长按移动{#1FE3BF,icon=👣}", "		剪切板{#90D7C5,icon=✂}", "	多端同步{#00B3FF,icon=📲}", "		Android{#99CC33}", "		iPhone{#FFCC33}", "		微信公众号{#00B8B8}", "	团队协作{#666666,icon=👥}", "		任务分发{#40BACA,icon=📌}", "		编辑同步{#1FE3BF,icon=📑}", "	时间管理{#7A95FF,icon=⌛}", "		利用碎片时间{#52D6EB}", "		事件提醒{#FFCC33}", "	创意分享{#8000FF,icon=💭}", "		连接投影 创意无限{#FF9900,icon=🎥}", "		QQ/微信/朋友圈{#00B8B8}", "		手机联系人{#52D6EB,icon=📞}", "		email{#7A95FF,icon=📩}", "	展望无限{#52D6EB}" ], c = [ "商业计划", "	运用场景", "		思维整理", "			#利用碎片时间，随时随地记录和完善自己的创意，计划", "		思考辅助", "			#积累一定用户数据之后， 可以从内容， 和结构两个纬度建模， 更好的给用户计划，创意提供指导和建议", "		创意分享", "			#微信朋友圈，好友，亲人朋友，有话慢慢说", "		讲稿展示", "			#偶尔需要你分享点什么东西的时候，你如果没有时间准备讲稿，可以在你吃饭的时候， 排队的时候， 完成讲稿编写", "	开发计划", "		朋友圈试用(2月15日)", "			流畅编辑/便捷分享", "			微信/iPhone/Android", "		正式发布(3月/1日)", "			Native性能优化", "			云存储正式上线", "		PC+投影支持(4月)", "			PC播放与编辑适配", "			手持设备遥控支持", "		组建产品团队(6月)", "			推广/验证需求", "			产品改良", "			寻找合伙人", "		组建数据和AI团队(待定...)", "			上线思维智能引导功能", "			思考相关商业模式", "		收费版(待定...)", "			群组/团队管理", "			私有云", "			协同编辑", "			...", "	推广计划", "		普通版冲量", "		高级功能体验", "		  #鼓励分享。", "		  #开启协同编辑，本身需要一个朋友圈。", "		营销/借力", "		  #事件营销。知识分享", "		微信应用号", "		  #寻求合作。", "	盈利模式", "		精准广告", "		  #思维整理，相对于资讯浏览有更强的目的性。 可以从这些信息里面提炼主题，做精准广告。", "		高端版收费", "		  #高级功能收费 如团队协作。", "		  #模仿github的模式,针对团队私有的想法云收费。" ], m = "CLUB.QQSK.COMPASS.", w = localStorage.getItem(m);
w && (y = JSON.parse(w)), y instanceof Array || (y = [], console.warn("reset your data!!!"), 
a(m));
var D = function(e, a, t) {
var r = {
type: e
};
switch (e) {
case "touchstart":
return ce(r, a, t);
case "touchmove":
return fe(r, a, t);
case "touchend":
case "touchcancel":
return se(r, a, t);
}
};
if (!window.requestAnimationFrame) {
for (var A = [ "webkit", "moz", "o", "ms" ], k = A.length; k--; ) if (requestAnimationFrame = window[A[k] + "RequestAnimationFrame"], 
requestAnimationFrame) {
cancelAnimationFrame = window[A[k] + "CancelAnimationFrame"];
break;
}
requestAnimationFrame || (requestAnimationFrame = function(e) {
return setTimeout(e, 1e3 / 60);
}, cancelAnimationFrame = function(e) {
return clearTimeout(e);
});
}
var $, G, X, H, U, Q, K, Z, V, te, re, ne, ie, le, E = 0, N = +new Date(), Y = [], _ = 0, q = 0, W = 0, J = 0, L = requestAnimationFrame, z = "touchstart,touchmove,touchend,touchcancel,mousedown,mousemove,mouseup,mouseout".split(","), ee = 10, ae = -1, k = z.length;
window.matchMedia && window.matchMedia("(pointer:coarse)").matches && z.splice(4);
var ge = "#eee", me = "#888", ye = "#4cd4bc", we = "#EEE", De = function(e) {
return Xe ? new ze(e) : document.createElement("canvas");
}, Ae = 0, ke = 1, Pe = 2, Oe = 3, Ee = 0, Be = 1, Re = 2, je = 3, Ne = 4, Ye = 5, _e = 6, qe = 7, We = 8, Je = 9, Le = 10, $e = 11, Ge = 2 * Math.PI, Xe = window.nativeHost;
ze.prototype.commit = function(e) {
var a = Xe.commit(this.nativeId, this.cmds.join(""), !!e);
return this.cmds = [], a;
}, "font,fillStyle,strokeStyle,lineCap,lineJoin,miterLimit,lineWidth,textAlign,textBaseline".replace(/\w+/g, function(e) {
Object.defineProperty(ze.prototype, e, {
get: function() {
return this._style[e];
},
set: function(a) {
this._style[e] !== a && (this._styleJSON = 0, this._style[e] = a);
}
});
}), Object.defineProperty(ze.prototype, "width", {
get: function() {
return this._width;
},
set: function(e) {
Xe.setWidth(this.nativeId, e), this._width = e;
}
}), Object.defineProperty(ze.prototype, "height", {
get: function() {
return this._height;
},
set: function(e) {
Xe.setHeight(this.nativeId, e), this._height = e;
}
});
var Ze = "BLACK,#FF000000,DKGRAY,#FF444444,GRAY,#FF888888,LTGRAY,#FFCCCCCC,WHITE,#FFFFFFFF,RED,#FFFF0000,GREEN,#FF00FF00,BLUE,#FF0000FF,YELLOW,#FFFFFF00,CYAN,#FF00FFFF,MAGENTA,#FFFF00FF,TRANSPARENT,#00000000".split(",");
ze.prototype.fill = function() {
He(this, Be, Ue(this._path));
}, ze.prototype.stroke = function() {
He(this, Ee, Ue(this._path));
}, ze.prototype.drawImage = function(e) {
var c = [];
switch (c.push.apply(c, arguments), c.length) {
case 3:
case 5:
case 9:
e.cmds.length && He(this, $e, e), c[0] = e.nativeId, He(this, Re, Ue(c));
break;
default:
console.error("error arguments" + c);
}
}, ze.prototype.measureText = function(e) {
return {
width: He(this, Je, e)
};
}, ze.prototype.fillText = function(e, a, t, r) {
He(this, je, Ue([ a, t, 0 | r ]) + e);
}, ze.prototype.strokeText = function(e, a, t, r) {
He(this, Ne, Ue([ a, t, 0 | r ]) + e);
}, ze.prototype.clearRect = function(e, a, t, r) {
He(this, Ye, Ue([ e, a, t, r ]));
}, ze.prototype.beginPath = function() {
this._path = [];
}, ze.prototype.moveTo = function(e, a) {
ea(this).push(Ae, e, a);
}, ze.prototype.lineTo = function(e, a) {
ea(this).push(ke, e, a);
}, ze.prototype.closePath = function() {
ea(this).push(Pe);
}, ze.prototype.arc = function(e, a, t, r, n, i) {
var l = aa(r), o = aa(n - r);
ea(this).push(Oe, e, a, t, l, l + o, i ? 1 : 0);
}, ze.prototype.save = function() {
He(this, _e, "");
}, ze.prototype.restore = function() {
He(this, qe, "");
}, ze.prototype.translate = function(e, a) {
He(this, We, Ue([ e, a ]));
}, ze.prototype.rotate = function() {}, ze.prototype.setTransform = function() {}, 
ze.prototype.scale = function() {}, ze.prototype.transform = function() {}, ze.prototype.resetTransform = function() {}, 
ta.prototype = new String(), ze.prototype.createLinearGradient = function(e, a, t, r) {
return new ta("linear:" + [ 0 | e, 0 | a, 0 | t, 0 | r, "" ].join(","));
}, ze.prototype.createRadialGradient = function(e, a, t, r, n, i) {
return new ta("radial:" + [ 0 | e, 0 | a, 0 | t, 0 | r, 0 | n, 0 | i ].join(","));
}, ze.prototype.rect = function(e, a, t, r) {
this.moveTo(e, a), this.lineTo(e + t, a), this.lineTo(e + t, a + r), this.lineTo(e, a + r), 
this.closePath();
}, ze.prototype.strokeRect = function(e, a, t, r) {
this.rect(e, a, t, r), this.stroke();
}, ze.prototype.fillRect = function(e, a, t, r) {
this.rect(e, a, t, r), this.fill();
}, ze.prototype.getContext = function() {
return this;
}, ze.prototype.setLineDash = function() {}, ze.prototype.strokeText = function() {}, 
ze.prototype.arcTo = function() {}, ze.prototype.bezierCurveTo = function() {}, 
ze.prototype.clip = function() {}, ze.prototype.getImageData = function() {}, ze.prototype.putImageData = function() {}, 
ze.prototype.createImageData = function() {}, ze.prototype.createPattern = function() {}, 
ze.prototype.drawFocusIfNeeded = function() {}, ze.prototype.ellipse = function() {}, 
ze.prototype.getLineDash = function() {}, ze.prototype.isPointInPath = function() {}, 
ze.prototype.isPointInStroke = function() {}, ze.prototype.quadraticCurveTo = function() {};
var na, ia, la, va, ca, sa, ha, ya, Ua, Qa, Ka, Za, Va, et, lt, ot, vt, Ft, xt, St, Ct, Mt, bt, Tt, It, kt, Pt, Ot, Et, Bt, jt, Yt, Nr, Jr, Lr, $r, Gr, tn, rn, nn, ln, cn, hn, un, dn, pn, gn, yn, wn, Fn, xn, kn, Pn, En, Bn, Rn, jn, Yn, Vn, ei, ra = function(e) {
return lr(sa.children[e]);
}, oa = 2 * Math.PI, ua = [], da = 0, ga = at, ma = [], it = Me("canvas", 632), pt = [ gt, [] ], Dt = [], At = [], Rt = [], Gt = 0, Xt = 0, Ht = 0, yr = "STHeiti serif", wr = 160, Fr = 128, xr = 128, Sr = 300, Cr = 2, Mr = 2.4, br = .75, Tr = .7, Ir = 1.2, Dr = .8, Ar = 2.2, kr = "创建于：", Pr = "修改于：", Er = 180, Br = 600, Rr = [ "经典", "炫彩" ], jr = [ "#2B8567#1D9C7E#22B59A#4CD4BC#1FE3BF#90D7C5#98C0B4#04576B#227580#4699A3#40BACA#52D6EB#7DCADC#88B8CC#611023#991924#C24924#DE6530#E67B63#CC8F8F#AE7D7D#484570#68638C#8B85A8#B3AFC5#C8C6D4#CDCDD1#A3A1A8".match(/#\w+/g), "#8000FF#FF00FF#FF0080#FF3D3D#FF9900#FFD83D#A0F000#5000F0#3D64FF#7A95FF#00B3FF#85E0D1#00B8B8#666600#333399#FF0033#990066#FFCC33#CCCC00#666666#0066CC#336699#669933#99CC33#00FF80#663366#660000#000000".match(/#\w+/g) ], Yr = 0, _r = -1, qr = 0, Wr = -1, an = function() {
tn && (tn.style.display = "none", rn.style.display = "none", nn.dirty = !0, ln.title = tn.value, 
ln.content = rn.value, tn.blur(), rn.blur());
}, on = function() {
tn && "block" == tn.style.display && tn.focus();
}, fn = [ "常用", "更多" ], sn = 0, mn = 0, On = 0, Nn = [ "内容", "颜色", "图标", "√" ], Un = Me("canvas", 2), Qn = [], Kn = [], Zn = [ "⛺,🎃,🎯,🏈,🏀,🎵,🎤,🎹,🎑,🎄,⚽,🎾,🎱,🎶,🎼,🎻,🎈,🎋,🏉,🎳,⛳,🎺,🎷,🎸,🎏,🎉,🚵,🚴,🏁,🎨,🎭,🎬,🗿,🎊,🏇,🏆,🎿,🏂,🏊,🏄,🎆,🎇,🎣,🚶,🏃,💃,⚾,🎐,♨,🎠,🎡,🎢,🗽,🌉,⛲".split(","), "🙇,👽,👍,💖,💟,😁,😂,😍,🎅,👻,👎,💛,💙,😜,😝,😛,👼,💀,👌,💜,💚,😃,😄,😀,👦,😈,👊,❤,💝,😊,😉,😘,👧,👿,✊,💔,💗,😚,😗,😙,👨,👹,👋,💓,💕,😳,😔,😌,👩,👺,✋,💞,💘,😒,😞,😣,👲,👾,👐,💌,💍,😢,😭,😪,👴,😺,👆,💋,💏,😥,😰,😅,👵,😸,👇,💑,👫,😓,😩,😫,👶,😻,👉,👬,👭,😨,😱,😠,👱,😽,👈,👪,🙌,😡,😤,😖,👸,😼,🙏,👏,✌,😆,😋,😷,🙆,🙀,☝,💪,👂,😎,😴,😵,🙅,😿,👀,👃,👅,😲,😟,😦,🙍,😹,👄,😾,🙈,😧,😮,😬,🙎,🙉,🙊,💩,🙋,😐,😕,😯,💁,💆,👰,👯,👳,😶,😇,😏,👮,👷,💂,💇,😑,☺,🙁,🙂".split(","), "#⃣,💹,💰,💴,💵,⌛,⏰,⌚,0⃣,📈,💷,💶,💳,🕐,⏳,📅,1⃣,📉,💸,💲,💱,📆,🕛,🕧,2⃣,📊,〰,〽,3⃣,🕜,🕑,🕝,4⃣,5⃣,6⃣,7⃣,8⃣,🕒,🕞,🕓,9⃣,🔢,🔟,✖,➕,🕟,🕔,🕠,➖,➗,🇦,🇧,🇨,🕕,🕖,🕗,🇩,🇪,🇫,🇬,🇭,🕘,🕙,🕚,🇮,🇯,🇰,🇱,🇲,🕡,🕢,🕣,🇳,🇴,🇵,🇶,🇷,🕤,🕥,🕦,🇸,🇹,🇺,🇻,🇼,🇽,🇾,🇿".split(","), "👓,💄,🎩,🎓,👑,☕,🍵,🍶,👒,👟,👞,👡,👠,🍼,🍺,🍻,👢,👕,👔,👚,👗,🍸,🍹,🍷,🎽,👖,👘,👙,💼,🍴,🍕,🍔,👜,👝,👛,🎀,🌂,🍟,🍗,🍖,📛,💅,🍝,🍛,🍤,🍱,🍣,🍥,🍙,🍘,🍚,🍜,🍲,🍢,🍡,🍳,🍞,🍩,🍮,🍦,🍨,🍧,🎂,🍰,🍪,🍫,🍬,🍭,🍯,🍎,🍏,🍊,🍋,🍒,🍇,🍉,🍓,🍑,🍈,🍌,🍐,🍍,🍠,🍆,🍅,🌽".split(","), "⛽,✂,🔓,🔒,🔐,🔔,🔕,📢,💺,✒,🔏,🔑,🔧,📣,🔊,🔉,💎,✏,🔩,🔨,⚓,🔈,🔇,🎧,🎍,📏,💣,🔪,🔫,🎥,📷,📹,🎒,📐,💡,🔦,🔎,💻,📻,📡,🔮,🔬,🔍,🔭,🛁,📺,📼,📱,🛀,🚿,🚽,🚪,🚬,📲,📟,🎮,💊,💉,🎲,🃏,🎴,🔌,🔋,🀄,🎫,🏮,🎰".split(","), "📞,☎,📌,📍,📎,👤,👥,💬,📠,📦,📝,📑,🔖,💭,💤,👣,🎁,📧,📜,📋,📇,📰,📁,📂,📥,📤,📃,📄,📖,📚,📕,📗,📩,📨,📘,📙,📓,📔,📒,💿,📫,📪,📀,💽,💾,📬,📭,✉,📯,📮".split(","), "☀,☁,🐾,💐,🌸,🐶,🐺,🐱,❄,🔆,🌷,🍀,🌹,🐭,🐹,🐰,🔅,🌞,🌻,🌺,🍁,🐸,🐯,🐨,⛅,⚡,🍃,🍂,🌿,🐻,🐷,🐽,✨,⛄,🌾,🍄,🌵,🐮,🐗,🐵,☔,🌀,🌴,🌲,🌳,🐒,🐴,🐑,🌊,🌁,🌰,🌱,🌼,🐘,🐼,🐧,🌈,🌋,🗻,🌄,🌅,🐦,🐤,🐥,🌌,🌠,⭐,🌐,🌍,🐣,🐔,🐍,🌎,🌏,🌝,🌚,🌑,🐢,🐛,🐝,🌒,🌓,🌔,🌕,🌖,🐜,🐞,🐌,🌗,🌘,🌜,🌛,🌙,🐙,🐚,🐠,🔥,🌟,💫,💥,💢,🐟,🐬,🐳,💦,💨,💧,🐋,🐄,🐏,🐀,🐃,🐅,🐇,🐉,🐎,🐐,🐓,🐕,🐖,🐁,🐂,🐲,🐡,🐊,🐫,🐪,🐆,🐈,🐩".split(","), "🏠,🏡,🏫,🎪,🏢,🚢,⛵,🚤,🏣,🏥,🏦,🏪,🏩,🚣,🚀,✈,🏨,💒,⛪,🏬,🏤,🚁,🚂,🚊,🌃,🌇,🌆,🏯,🏰,🚉,🚞,🚆,🏭,🚄,🚅,🚈,🚇,🚝,🚋,🚃,🚎,🚌,🚍,🚙,🚘,🚗,🚕,🚖,🚛,🚚,🚨,🚓,🚔,🚒,🚑,🚐,🚲,🚡,🚟,🚠,🚜".split(","), "㊙,🔝,🔱,‼,⁉,🚫,⛔,🚦,㊗,🔚,❎,✅,❌,🚥,⚠,🚧,🔺,🔙,❗,❓,❕,🔞,📵,🚯,🔲,🔛,❔,⭕,✔,🚱,🚳,🚷,🔳,🔜,☑,♻,💯,🚸,💈,🚏,⚫,🔃,ℹ,⬆,⬇,🚩,🚻,🚹,⚪,⬅,➡,↗,↖,🚺,🚼,🚾,🔴,↘,↙,↔,↕,🚰,🚮,🅿,🔵,↩,↪,⤵,⤴,♿,🚭,🛂,🔻,📳,📴,🔄,◀,🛄,🛅,🛃,⬜,▶,🔼,🔽,⏪,🏧,🇯🇵,🇰🇷,⬛,⏩,⏫,⏬,🆗,🇩🇪,🇨🇳,🇺🇸,🔶,🔀,🔁,🔂,🆕,🇫🇷,🇪🇸,🇮🇹,🔷,🆙,🆒,🆓,🆖,🇷🇺,🇬🇧,📶,🔸,🎦,🔹,◼,◻,◾,◽,▪,▫,💠,🔯,💮,🔘,🔗,🈲,🈶,🈚,🈳,🈵,🉑,🆘,🆔,🆑,✳,❇,✴,🆚,🅰,🅱,🆎,🅾,♠,♥,♣,♦,©,®,™,Ⓜ,➿,➰,♈,♉,♊,♋,♌,♍,♎,♏,♐,♑,♒,♓,⛎,🔣,🔠,🔡,🔤,🈯,🈴,🉐,🈹,🈺,🈷,🈸,🔰".split(",") ], ai = "iPhone" == navigator.platform && 20;
ti("🎄,🎠,🏈,🎹", "🎄,🎤,🎶,🎣,🎯,⚽"), ti("😀,👍,💗,🎅", "😀,😭,😥,😡,😴,😷,👽,👻,💘,💔,💓,👌,✌,👍,👎,🙏"), 
ti("📅,💰,📈,⌛", "⏰,💰,💹"), ti("🍴,🎂,🎀,👒", "🍭,🍲,🍎,🍸"), ti("💣,📏,🔬,🔐", "🔓,🔒,⚓,🔧,🔍,🔔,🔕,💡,💎,💣"), 
ti("📞,📌,👥,💬", "👤,👥,💬,💭,📞,📩"), ti("🐧,🐣,🍄,🔆", "🐌,🌹,🔆,⛅,❄,☁,💧"), 
ti("🚊,🚔,🏠,💒", "🏡,🚀,🚄,⛵,🚲"), ti("⛔,🚭,🚦,✅", "✅,❎,❓,❗,⁉,㊙,🚩");
var yi, wi, Fi, xi, Si, Ci, pi = "娱乐,表情,数字,居家,杂物,沟通,自然,城市,抽象".split(","), gi = Ta, mi = Me("canvas", 12);
return {
dispatchEvent: D,
init: wa
};
}();</script>
<script>
function init(){
	var width = document.body.clientWidth;
	var height = document.body.clientHeight;
	
	if(!width && window.nativeHost){
		width = nativeHost.getWidth(0);
		height = nativeHost.getHeight(0);
	}
	if(width && height){
		//minimum-scale=1.0, maximum-scale=1.0, user-scalable=no
		//document.getElementsByTagName('meta')[0].setAttribute('content','width=980,initial-scale='+scale+',user-scalable=no')
		//compass.init(960,Math.ceil(height*scale))
		compass.init(width,height)
		init = Function.prototype;
	}
}
//var start = +new Date,inc = 0;requestAnimationFrame(testFPS);function testFPS(){if(inc++==60){if(prompt('刷新率:',inc/(new Date - start) * 1000))return;start = +new Date;inc = 0}requestAnimationFrame(testFPS);
//var c = document.body.firstChild.getContext('2d');var t = +new Date;while(new Date - t<3)c.fillRect(0,Math.random()*900|0,100,100);}
window.onload = init;
</script>
</head>
<body></body>
</html>